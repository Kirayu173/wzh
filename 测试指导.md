按当前项目配置整理了一份「后端 + 前端启动 + 手测指南」，包含数据库初始化、启动命令、关键手测流程与常用 curl。

**环境准备**

* JDK 11、Maven 3.8+
* MySQL 8.x（后端默认 **8080** 端口）
* Android Studio + SDK（或 Gradle CLI + 模拟器/真机）
* 可选：Postman 或 curl

**后端启动**

* 配置文件：**application.yml**
  * 端口：**8080**
  * 数据库：**suyuan**，用户名 **suyuan_app**，密码 **Suyuan@12345**
  * **spring.jpa.hibernate.ddl-auto: none** → 必须先建库建表

1. 创建数据库与用户

`<span><span>CREATE</span><span> DATABASE IF </span><span>NOT</span><span></span><span>EXISTS</span><span> suyuan </span><span>DEFAULT</span><span></span><span>CHARACTER SET</span><span> utf8mb4; </span><span>CREATE</span><span></span><span>USER</span><span> IF </span><span>NOT</span><span></span><span>EXISTS</span><span></span><span>'suyuan_app'</span><span>@</span><span>'%'</span><span> IDENTIFIED </span><span>BY</span><span></span><span>'Suyuan@12345'</span><span>; </span><span>GRANT</span><span></span><span>ALL</span><span> PRIVILEGES </span><span>ON</span><span> suyuan.</span><span>*</span><span></span><span>TO</span><span></span><span>'suyuan_app'</span><span>@</span><span>'%'</span><span>; FLUSH PRIVILEGES; </span></span>`

2. 建表（根据当前实体字段）

```<span><span>``USE suyuan;

`<span>`CREATE TABLE `<span>` IF `<span>`NOT `<span><span>`EXISTS `<span><span>`user `<span>` (
  id `<span>`BIGINT `<span><span>`PRIMARY KEY `<span>` AUTO_INCREMENT,
  username `<span>`VARCHAR `<span>`(`<span>`64 `<span>`) `<span>`NOT NULL `<span><span>`UNIQUE `<span>`,
  password_hash `<span>`VARCHAR `<span>`(`<span>`255 `<span>`) `<span>`NOT NULL `<span>`,
  phone `<span>`VARCHAR `<span>`(`<span>`20 `<span>`),
  role `<span>`VARCHAR `<span>`(`<span>`32 `<span>`),
  create_time DATETIME
);

`<span>`CREATE TABLE `<span>` IF `<span>`NOT `<span><span>`EXISTS `<span>` product (
  id `<span>`BIGINT `<span><span>`PRIMARY KEY `<span>` AUTO_INCREMENT,
  name `<span>`VARCHAR `<span>`(`<span>`128 `<span>`) `<span>`NOT NULL `<span>`,
  price `<span>`DECIMAL `<span>`(`<span>`10 `<span>`,`<span>`2 `<span>`) `<span>`NOT NULL `<span>`,
  stock `<span>`INT `<span><span>`NOT NULL `<span>`,
  cover_url `<span>`VARCHAR `<span>`(`<span>`255 `<span>`),
  `</span><span>desc</span><span>` TEXT,
  origin `<span>`VARCHAR `<span>`(`<span>`64 `<span>`),
  status `<span>`VARCHAR `<span>`(`<span>`32 `<span>`),
  create_time DATETIME
);

`<span>`CREATE TABLE `<span>` IF `<span>`NOT `<span><span>`EXISTS `<span>` product_image (
  id `<span>`BIGINT `<span><span>`PRIMARY KEY `<span>` AUTO_INCREMENT,
  product_id `<span>`BIGINT `<span><span>`NOT NULL `<span>`,
  url `<span>`VARCHAR `<span>`(`<span>`255 `<span>`) `<span>`NOT NULL `<span>`,
  sort `<span>`INT `<span>`,
  INDEX idx_product_image_product (product_id)
);

`<span>`CREATE TABLE `<span>` IF `<span>`NOT `<span><span>`EXISTS `<span>` address (
  id `<span>`BIGINT `<span><span>`PRIMARY KEY `<span>` AUTO_INCREMENT,
  user_id `<span>`BIGINT `<span><span>`NOT NULL `<span>`,
  receiver `<span>`VARCHAR `<span>`(`<span>`64 `<span>`) `<span>`NOT NULL `<span>`,
  phone `<span>`VARCHAR `<span>`(`<span>`20 `<span>`) `<span>`NOT NULL `<span>`,
  province `<span>`VARCHAR `<span>`(`<span>`32 `<span>`),
  city `<span>`VARCHAR `<span>`(`<span>`32 `<span>`),
  detail `<span>`VARCHAR `<span>`(`<span>`255 `<span>`),
  is_default TINYINT(`<span>`1 `<span>`),
  create_time DATETIME,
  INDEX idx_address_user (user_id)
);

`<span>`CREATE TABLE `<span>` IF `<span>`NOT `<span><span>`EXISTS `<span>` cart_item (
  id `<span>`BIGINT `<span><span>`PRIMARY KEY `<span>` AUTO_INCREMENT,
  user_id `<span>`BIGINT `<span><span>`NOT NULL `<span>`,
  product_id `<span>`BIGINT `<span><span>`NOT NULL `<span>`,
  quantity `<span>`INT `<span><span>`NOT NULL `<span>`,
  selected TINYINT(`<span>`1 `<span>`) `<span>`NOT NULL `<span>`,
  price_snapshot `<span>`DECIMAL `<span>`(`<span>`10 `<span>`,`<span>`2 `<span>`),
  product_name `<span>`VARCHAR `<span>`(`<span>`128 `<span>`),
  product_image `<span>`VARCHAR `<span>`(`<span>`255 `<span>`),
  create_time DATETIME,
  update_time DATETIME,
  INDEX idx_cart_user (user_id),
  INDEX idx_cart_product (product_id)
);

`<span>`CREATE TABLE `<span>` IF `<span>`NOT `<span><span>`EXISTS `<span>` `</span><span>order</span><span>` (
  id `<span>`BIGINT `<span><span>`PRIMARY KEY `<span>` AUTO_INCREMENT,
  user_id `<span>`BIGINT `<span><span>`NOT NULL `<span>`,
  total_amount `<span>`DECIMAL `<span>`(`<span>`10 `<span>`,`<span>`2 `<span>`),
  status `<span>`VARCHAR `<span>`(`<span>`32 `<span>`) `<span>`NOT NULL `<span>`,
  pay_time DATETIME,
  confirm_time DATETIME,
  ship_time DATETIME,
  express_no `<span>`VARCHAR `<span>`(`<span>`64 `<span>`),
  express_company `<span>`VARCHAR `<span>`(`<span>`64 `<span>`),
  receiver `<span>`VARCHAR `<span>`(`<span>`64 `<span>`),
  phone `<span>`VARCHAR `<span>`(`<span>`20 `<span>`),
  address `<span>`VARCHAR `<span>`(`<span>`255 `<span>`),
  memo `<span>`VARCHAR `<span>`(`<span>`255 `<span>`),
  request_id `<span>`VARCHAR `<span>`(`<span>`64 `<span>`),
  create_time DATETIME,
  `<span>`UNIQUE `<span>` KEY uk_order_request (user_id, request_id),
  INDEX idx_order_user (user_id),
  INDEX idx_order_status (status)
);

`<span>`CREATE TABLE `<span>` IF `<span>`NOT `<span><span>`EXISTS `<span>` order_item (
  id `<span>`BIGINT `<span><span>`PRIMARY KEY `<span>` AUTO_INCREMENT,
  order_id `<span>`BIGINT `<span><span>`NOT NULL `<span>`,
  product_id `<span>`BIGINT `<span><span>`NOT NULL `<span>`,
  price `<span>`DECIMAL `<span>`(`<span>`10 `<span>`,`<span>`2 `<span>`),
  quantity `<span>`INT `<span>`,
  product_name `<span>`VARCHAR `<span>`(`<span>`128 `<span>`),
  product_image `<span>`VARCHAR `<span>`(`<span>`255 `<span>`),
  INDEX idx_order_item_order (order_id)
);

`<span>`CREATE TABLE `<span>` IF `<span>`NOT `<span><span>`EXISTS `<span>` trace_batch (
  id `<span>`BIGINT `<span><span>`PRIMARY KEY `<span>` AUTO_INCREMENT,
  product_id `<span>`BIGINT `<span><span>`NOT NULL `<span>`,
  trace_code `<span>`VARCHAR `<span>`(`<span>`64 `<span>`) `<span>`NOT NULL `<span><span>`UNIQUE `<span>`,
  batch_no `<span>`VARCHAR `<span>`(`<span>`64 `<span>`),
  origin `<span>`VARCHAR `<span>`(`<span>`128 `<span>`),
  producer `<span>`VARCHAR `<span>`(`<span>`128 `<span>`),
  harvest_date `<span>`DATE `<span>`,
  process_info `<span>`VARCHAR `<span>`(`<span>`2000 `<span>`),
  test_org `<span>`VARCHAR `<span>`(`<span>`128 `<span>`),
  test_date `<span>`DATE `<span>`,
  test_result `<span>`VARCHAR `<span>`(`<span>`255 `<span>`),
  report_url `<span>`VARCHAR `<span>`(`<span>`255 `<span>`),
  create_time DATETIME,
  INDEX idx_trace_product (product_id)
);

`<span>`CREATE TABLE `<span>` IF `<span>`NOT `<span><span>`EXISTS `<span>` logistics_node (
  id `<span>`BIGINT `<span><span>`PRIMARY KEY `<span>` AUTO_INCREMENT,
  trace_code `<span>`VARCHAR `<span>`(`<span>`64 `<span>`) `<span>`NOT NULL `<span>`,
  node_time DATETIME `<span>`NOT NULL `<span>`,
  location `<span>`VARCHAR `<span>`(`<span>`128 `<span>`),
  status_desc `<span>`VARCHAR `<span>`(`<span>`255 `<span>`),
  INDEX idx_logistics_trace (trace_code)
);
`

3. 启动后端

`<span><span>cd</span><span> backend mvn spring-boot:run </span></span>`

4. 健康检查

`<span><span>curl http://localhost:8080/health </span></span>`

**前端(Android)启动**

* Base URL：**NetworkConfig.java**
  * 模拟器使用 **http://10.0.2.2:8080/**
  * 真机需改为 PC 局域网 IP（例如 **http://192.168.1.100:8080/**）

方式一（Android Studio）

* 打开 **android/** 工程 → Sync → 运行 app

方式二（命令行）

`<span><span>cd</span><span> android ./gradlew :app:assembleDebug </span><span># 或安装到已连接设备/模拟器</span><span> ./gradlew :app:installDebug </span></span>`

**手测准备（账户与权限）**

1. 注册普通用户（App 内注册即可），或用 curl：

`<span><span>curl -H </span><span>"Content-Type: application/json"</span><span> \   -d </span><span>'{"username":"user1","password":"123456","phone":"13800000000"}'</span><span> \   http://localhost:8080/auth/register </span></span>`

2. 注册管理员账号（先注册，再改角色）：

`<span><span>curl -H </span><span>"Content-Type: application/json"</span><span> \   -d </span><span>'{"username":"admin1","password":"123456","phone":"13900000000"}'</span><span> \   http://localhost:8080/auth/register </span></span>`

3. 在数据库将管理员角色改为 **admin**：

`<span><span>UPDATE</span><span></span><span>user</span><span></span><span>SET</span><span> role</span><span>=</span><span>'admin'</span><span></span><span>WHERE</span><span> username</span><span>=</span><span>'admin1'</span><span>; </span></span>`

**手测流程（重点功能）**

* 登录 & 入口验证
  * 用普通用户登录 → 个人中心版本号连点 5 次 → 提示“无权限”
  * 用管理员登录 → 个人中心版本号连点 5 次 → 进入管理端首页
* 商品管理
  * 进入「商品管理」→ 新增商品（名称/价格/库存必填，封面 URL 可选）
  * 列表中操作：上/下架、修改库存、删除
  * 验证：状态切换后列表刷新，库存更新正确
* 订单管理（需要先生成订单）
  * 普通用户：浏览商品 → 加入购物车 → 下单 → 模拟支付（订单变 PAID）
  * 管理端：订单列表筛选「待发货」→ 发货（填写快递公司/单号）→ 状态变 SHIPPED
  * 普通用户：订单详情显示发货信息 → 可确认收货（变 COMPLETED）
* 溯源管理
  * 管理端：新增溯源批次（填写产品ID、产地、生产方等）
  * 添加物流节点（nodeTime 必填，格式 **yyyy-MM-ddTHH:mm:ss**）
  * 二维码预览：显示 PNG 图
  * 验证：**GET /trace/{traceCode}** 物流节点倒序

**常用后端手测 curl**

```<span><span>``# 登录获取 token<span>``curl -H<span>``"Content-Type: application/json"<span>``   -d<span>``'{"username":"admin1","password":"123456"}'<span>``
  http://localhost:8080/auth/login

`<span>`# 创建商品 `<span>`
curl -H `<span>`"Authorization: Bearer `<token>`"`<span>` -H `<span>`"Content-Type: application/json"`<span>`
  -d `<span>`'{"name":"苹果","price":12.5,"stock":100,"origin":"山东","status":"online"}'`<span>`
  http://localhost:8080/admin/products

`<span>`# 发货 `<span>`
curl -H `<span>`"Authorization: Bearer `<token>`"`<span>` -H `<span>`"Content-Type: application/json"`<span>`
  -d `<span>`'{"expressNo":"SF123","expressCompany":"顺丰"}'`<span>`
  http://localhost:8080/admin/orders/100/ship

`<span>`# 新增溯源批次 `<span>`
curl -H `<span>`"Authorization: Bearer `<token>`"`<span>` -H `<span>`"Content-Type: application/json"`<span>`
  -d `<span>`'{"productId":1,"origin":"山东","producer":"合作社A"}'`<span>`
  http://localhost:8080/admin/trace
`

**自动化测试（可选）**

* 后端：
  `<span><span>cd</span><span> backend mvn </span><span>test</span><span> </span></span>`
* Android：
  `<span><span>cd</span><span> android ./gradlew :app:lint </span></span>`

如果你希望我补一份带截图/录屏的手测 checklist（按 AC 编号），告诉我你要覆盖哪些模块即可。





已新增一个可直接由后端静态资源托管的 Web 管理端，包含登录、商品/订单/溯源管理与发货/物流节点/二维码能力，同时补了一份依赖清单。入口放在 **/admin-web/**，避免与 **/admin/**** API 冲突，并在安全配置里放行静态资源。

改动位置与原因

* **SecurityConfig.java**：放行 **/admin-web/****，确保登录页与静态资源可访问。
* **index.html**：管理端单页入口与结构。
* **styles.css**：视觉与布局样式。
* **admin.js**：登录、列表/表单、发货、物流、二维码交互逻辑。
* **DEPENDENCIES.md**：所需依赖与后端接口清单。

你可以这样用

* 启动后端后访问：**http://localhost:8080/admin-web/**
* 登录管理员账号后即可操作（如需管理员角色，按现有测试指导把用户 role 改为 **admin**）

我未运行测试或服务。
如果你需要，我可以再补一个管理端使用说明或把界面文案改成中文。

下一步建议

1. 启动后端并打开 **http://localhost:8080/admin-web/** 验证登录与列表加载。
2. 若要对外部署管理端，确认反向代理或同源托管策略。
